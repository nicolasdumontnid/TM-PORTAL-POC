<div class="container">
  <div class="header">
    <div class="logo">üè• Clinique du Parc</div>
    <div class="subtitle">Medical Reporting System</div>
  </div>
  
  <div class="patient-info">
    <div class="info-section">
      <h3>Patient Information</h3>
      <div class="info-row">
        <span class="label">Name:</span>
        <span class="value">{{patientData.name}}</span>
      </div>
      <div class="info-row">
        <span class="label">Date of Birth:</span>
        <span class="value">{{patientData.dateOfBirth}}</span>
      </div>
      <div class="info-row">
        <span class="label">Address:</span>
        <span class="value">{{patientData.address}}</span>
      </div>
    </div>
    
    <div class="info-section">
      <h3>Prescribing Doctor</h3>
      <div class="info-row">
        <span class="label">Name:</span>
        <span class="value">{{doctorData.name}}</span>
      </div>
      <div class="info-row">
        <span class="label">Specialty:</span>
        <span class="value">{{doctorData.specialty}}</span>
      </div>
      <div class="info-row">
        <span class="label">Hospital:</span>
        <span class="value">{{doctorData.hospital}}</span>
      </div>
    </div>
  </div>
  
  <div class="report-section">
    <div class="section-header">Indication</div>
    <div class="section-content">
      <textarea [(ngModel)]="reportSections.indication" placeholder="Enter indication..."></textarea>
    </div>
  </div>
  
  <div class="report-section">
    <div class="section-header">Technical Information</div>
    <div class="section-content">
      <textarea [(ngModel)]="reportSections.technicalInformation" placeholder="Enter technical information..."></textarea>
    </div>
  </div>
  
  <div class="report-section">
    <div class="section-header">Report</div>
    <div class="section-content">
      <textarea [(ngModel)]="reportSections.report" placeholder="Enter report..."></textarea>
    </div>
  </div>
  
  <div class="report-section">
    <div class="section-header">Conclusion</div>
    <div class="section-content">
      <textarea [(ngModel)]="reportSections.conclusion" placeholder="Enter conclusion..."></textarea>
    </div>
  </div>
  
  <div class="report-section">
    <div class="section-header">Billing</div>
    <div class="section-content">
      <textarea [(ngModel)]="reportSections.billing" placeholder="Enter billing information..."></textarea>
    </div>
  </div>
  
  <div class="report-section">
    <div class="section-header">Findings - Measurements</div>
    <div class="section-content">
      <div class="findings-container">
        <!-- Measurement Timeline -->
        <div class="measurement-timeline">
          <div 
            *ngFor="let measurement of measurements" 
            class="timeline-item"
            [class.active]="selectedMeasurement === measurement"
            (click)="selectMeasurement(measurement)"
          >
            <div class="timeline-header">
              <i class="fas fa-cog"></i>
              <div class="timeline-info">
                <div class="timeline-date">{{measurement.date}}</div>
                <div class="timeline-label">{{measurement.label}}</div>
              </div>
            </div>
          </div>
          
          <!-- Empty slot -->
          <div class="timeline-item empty">
            <div class="timeline-header">
              <i class="fas fa-cog"></i>
              <div class="timeline-info">
                <div class="timeline-label">Empty</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Images Section -->
        <div class="images-section">
          <div class="image-grid">
            <div *ngFor="let nodule of selectedMeasurement.nodules" class="image-item">
              <div class="medical-image-container">
                <img src="https://images.unsplash.com/photo-1559757148-5c350d0d3c56?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&q=80" 
                     alt="Medical scan" class="medical-scan">
                <div class="measurement-overlay">
                  <div class="measurement-line"></div>
                  <div class="measurement-value">{{nodule.size}}mm</div>
                </div>
              </div>
              <div class="image-label">{{nodule.name}}</div>
            </div>
          </div>
        </div>

        <!-- Evolution Charts -->
        <div class="evolution-section">
          <div class="evolution-header">
            <h4>Evolution Individual</h4>
          </div>
          
          <div class="charts-container">
            <div *ngFor="let nodule of selectedMeasurement.nodules" class="chart-item">
              <div class="chart-header">
                <span class="nodule-name">{{nodule.name}}</span>
              </div>
              
              <div class="chart-container">
                <svg class="evolution-chart" viewBox="0 0 200 100">
                  <!-- Grid lines -->
                  <defs>
                    <pattern id="grid" width="20" height="10" patternUnits="userSpaceOnUse">
                      <path d="M 20 0 L 0 0 0 10" fill="none" stroke="#444" stroke-width="0.5"/>
                    </pattern>
                  </defs>
                  <rect width="200" height="100" fill="url(#grid)" />
                  
                  <!-- Evolution line -->
                  <ng-container *ngFor="let data of getEvolutionData(nodule.id); let i = index">
                    <circle 
                      *ngIf="i < getEvolutionData(nodule.id).length - 1"
                      [attr.cx]="30 + (i * 60)" 
                      [attr.cy]="80 - (data.size - 8) * 4" 
                      r="3" 
                      fill="#ff6b6b"
                    />
                    <line 
                      *ngIf="i < getEvolutionData(nodule.id).length - 1"
                      [attr.x1]="30 + (i * 60)"
                      [attr.y1]="80 - (data.size - 8) * 4"
                      [attr.x2]="30 + ((i + 1) * 60)"
                      [attr.y2]="80 - (getEvolutionData(nodule.id)[i + 1].size - 8) * 4"
                      stroke="#ff6b6b"
                      stroke-width="2"
                    />
                  </ng-container>
                  
                  <!-- Current point -->
                  <circle 
                    [attr.cx]="30 + ((getEvolutionData(nodule.id).length - 1) * 60)" 
                    [attr.cy]="80 - (nodule.size - 8) * 4" 
                    r="4" 
                    fill="#ff6b6b"
                    stroke="#fff"
                    stroke-width="2"
                  />
                </svg>
              </div>
              
              <div class="measurement-stats">
                <div class="stat-item">
                  <span class="stat-value" [class]="getChangeClass(nodule.changePercent)">
                    {{nodule.changePercent !== null ? (nodule.changePercent > 0 ? '+' : '') + nodule.changePercent + '%' : '--'}}
                  </span>
                </div>
                <div class="stat-item">
                  <span class="stat-value" [class]="getChangeClass(nodule.change)">
                    {{nodule.change !== null ? (nodule.change > 0 ? '+' : '') + nodule.change + 'mm' : '--'}}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="actions">
    <button class="btn btn-secondary" (click)="onSecondOpinion()">Second Opinion</button>
    <button class="btn btn-warning" (click)="onHold()">On Hold</button>
    <button class="btn btn-primary" (click)="onSign()">Sign</button>
    <button class="btn btn-success" (click)="onSignAndNext()">Sign & Next</button>
  </div>
</div>